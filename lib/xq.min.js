(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var nextTick;!function(){function e(){for(;n.next;){n=n.next;var t=n.task;n.task=void 0;var o=n.domain;o&&(n.domain=void 0,o.enter());try{t()}catch(a){if(s)throw o&&o.exit(),setTimeout(e,0),o&&o.enter(),a;setTimeout(function(){throw a},0)}o&&o.exit()}i=!1}var n={task:void 0,next:null},t=n,i=!1,o=void 0,s=!1;if(nextTick=function(e){t=t.next={task:e,domain:s&&process.domain,next:null},i||(i=!0,o())},"undefined"!=typeof process&&process.nextTick)s=!0,o=function(){process.nextTick(e)};else if("function"==typeof setImmediate)o="undefined"!=typeof window?setImmediate.bind(window,e):function(){setImmediate(e)};else if("undefined"!=typeof MessageChannel){var a=new MessageChannel;a.port1.onmessage=function(){o=c,a.port1.onmessage=e,e()};var c=function(){a.port2.postMessage(0)};o=function(){setTimeout(e,0),c()}}else o=function(){setTimeout(e,0)};return nextTick}(),module.exports=nextTick;
},{}],2:[function(require,module,exports){
(function(){var t,n,e,r={}.hasOwnProperty;n=require("./xq"),e=function(t,n){var e,o;for(e in n)r.call(n,e)&&(o=n[e],t[e]=o);return t},module.exports=t=function(){function t(t){e(this,t)}return t.prototype.min=0,t.prototype.base=1.2,t.prototype.exp=33,t.prototype.defaultMax=5,t.prototype.defaultDelay=1e3,t.prototype.delay=function(t,n){return this.min+Math.floor(n*Math.pow(this.base,Math.min(this.exp,t))+n/2*Math.random())},t.prototype["try"]=function(t,e,r){var o,u;return u=this,2===arguments.length?(t=arguments[0],r=arguments[1],e=this.defaultDelay):1===arguments.length&&(r=arguments[0],t=this.defaultMax,e=this.defaultDelay),o=null,n.binder(function(i,a){var l;return(l=function(s){var f,h,p;return s>=t?(i(o,!0),void a()):(p=r(),f=!1,h=function(t){return f?void 0:(f=!0,o=t,(e=u.delay(s,e))>=0?setTimeout(function(){return l(s+1)},e):(i(new Error("Abort with "+e),!0),a()),null)},p instanceof n?p.then(i,h).onEnd(function(){return p.isRejected()?void 0:a()}):p.then(function(t){return i(t),a()},h),null)})(0),null})},t}()}).call(this);
},{"./xq":3}],3:[function(require,module,exports){
(function(){var t,r,n,e,i,o,u,s,h,l,c,p,_,f,a,d,y,v,E,x,g,m,w,j,b,C,A,O,N=function(t,r){return function(){return t.apply(r,arguments)}},q=[].slice;n={ini:0},r={fin:0},e={nva:0},s=0,module.exports=i=function(){function t(r){this._doEnd=N(this._doEnd,this),this._resolverExit=N(this._resolverExit,this),this._end=N(this._end,this),this._reject=N(this._reject,this),this._resolve=N(this._resolve,this),this._pushError=N(this._pushError,this),this._push=N(this._push,this);var e,i;return this instanceof t?(this._cnt=s++,void(r===n?this._value=n:("boolean"==typeof(e=arguments[1])&&(i=e),i?this._reject(r):this._resolve(r)))):new t(r)}return t.prototype._value=n,t.prototype._isError=!1,t.prototype._isEnded=!1,t.prototype._isEnding=!1,t.prototype._type="root",t.prototype._resolver=null,t.prototype._fx=null,t.prototype._fe=null,t.prototype._prev=null,t.prototype._next=null,t.prototype._execCount=0,t.prototype._serial=!1,t.prototype._head=null,t.prototype._tail=null,t.prototype._onEnd=null,t.prototype._endOnError=!1,t.prototype.inspect=function(){var t;return t=this._value===n?"_":this._value+"","{"+this._type+this._cnt+": v:"+t+", err:"+this._isError+", "+("end:"+this._isEnded+", exec:"+this._execCount+", ser:"+this._serial+"}")},t.reject=function(r){return new t(r,!0)},t.resolver=function(r){var e;return e=new t(n)._defer(),r(function(t){return void e.resolve(t)},function(t){return void e.reject(t)}),e.promise},t.binder=function(r){var e,i,o,u;return e=new t(n)._defer(),o=function(t,r){return void(r?e.pushError(t):e.push(t))},i=function(){return void e.end()},u=r(o,i),"function"==typeof u&&e.promise.onEnd(u),e.promise},t.defer=function(r){return new t(n)._defer(r)},t.prototype.isPending=function(){return!this._isEnded},t.prototype.isEnded=function(){return this._isEnded},t.prototype.isRejected=function(){return this._isEnded&&this._isError},t.prototype.isFulfilled=function(){return this._isEnded&&!this._isError},t.prototype._defer=function(t){var r;return void 0!==t&&this._push(t),r=this,this._def||(this._def={push:r._push,pushError:r._pushError,resolve:r._resolve,reject:r._reject,end:r._end,promise:r,toString:function(){return"[object Defer]"}})},t.prototype._push=function(t){return this._exec(t,!1)},t.prototype._pushError=function(t){return this._exec(t,!0)},t.prototype._resolve=function(t){return this._push(t)._end()},t.prototype._reject=function(t){return this._pushError(t)._end()},t.prototype._end=function(){return this._exec(r,!1)},t.prototype._exec=function(t,n,e){var i;return this._isEnded||this._isEnding&&!e?this:t===r?(this._isEnding=!0,0!==this._execCount||(null!=(i=this._head)?i.next:void 0)||this._doEnd(),this):this._serial&&this._execCount>0?(this._enqueue(t,n),this):(this._execCount++,this._resolver(this._fx,this._fe,t,n,this._resolverExit)||this._resolverExit(t,n,!0),this)},t.prototype._enqueue=function(t,r){return this._head||(this._head={next:null},this._tail=this._head),this._tail=this._tail.next={next:null,v:t,isError:r}},t.prototype._nextEvent=function(){return this._head&&this._head.next?this._head=this._head.next:null},t.prototype._execNext=function(){var t;return 0===this._execCount&&(t=this._nextEvent())&&this._exec(t.v,t.isError,!0),this},t.prototype._resolver=function(t,r,n,e,i){return C(n,e,i),!0},t.prototype._resolverExit=function(t,r,n){var e,i,o;return n&&this._execCount--,this._setValue(t,r),e=this._isEnding&&0===this._execCount&&!(null!=(o=this._head)?o.next:void 0),i=r&&this._endOnError,(e||i)&&this._doEnd(),this._execNext()},t.prototype._doEnd=function(){var t,n,e,i,o,u;return this._isEnded?this:(this._isEnded=!0,null!=(u=this._prev)&&u._removeNext(this),this._head=this._tail=null,o=this._value,i=this._isError,this._onEnd&&(t=function(){var t,r,e,u;for(e=this._onEnd,u=[],t=0,r=e.length;r>t;t++)n=e[t],u.push(x(n,o,i));return u}.call(this)),t&&(e=t.reduce(function(t,r){return t||r},null)),this._forward(r,!1),setTimeout(function(){if(e)throw e},0),this)},t.prototype._setValue=function(t,r){return this._isEnded||t===e?this:(this._value=t,this._isError=r,this._forward(t,r))},t.prototype._forward=function(t,r){var n;return(null!=(n=this._next)?n.length:void 0)?(this._next.forEach(function(n){return n._exec(t,r)}),this):this},t.prototype._addNext=function(t){return this._next||(this._next=[]),this._next.push(t),t._prev=this,this._value!==n&&(t._exec(this._value,this._isError),this._isEnded&&!t._isEnded&&t._exec(r,!1)),t},t.prototype._removeNext=function(t){var r;return delete t._prev,(r=this._next.indexOf(t)>=0)&&this._next.splice(r,1),this},t.prototype.onEnd=function(t){var r;if(this._onEnd||(this._onEnd=[]),this._onEnd.push(t),this._isEnded&&(r=x(t,this._value,this._isError)),r)throw r;return this},t.prototype.endOnError=function(){return this._endOnError=!0,this},t.prototype.stop=function(){return this._doEnd()},t.prototype.toString=function(){return"[object Promise]"},t}(),i.toString=function(){return"[object X]"},x=function(){var t,r,n;n=arguments[0],t=2<=arguments.length?q.call(arguments,1):[];try{return void n.apply(null,t)}catch(e){return r=e}},a=function(t,r){var n,e,i;try{return null==t?!1:"object"!=(i=typeof t)&&"function"!==i?!1:(e=t.then,"function"==typeof e?e:!1)}catch(o){return n=o,r(n),!0}},f=function(t){return t instanceof i||a(t)},t={always:0},y=require("../lib/nexttick"),d=function(r){return function(n,e,i,o,u){var s,h,l;return(s=r===t||r===o?n:r===!1&&o===!0?e:void 0)?(l=this,h=this._immediate?function(t){return t()}:y,h(function(){var n,e;try{if(e=s.apply(void 0,r===t?[i,o]:[i]),e===l)throw new TypeError("f returned same promise");return C(e,!1,u)}catch(h){return n=h,C(n,!0,u)}}),!0):!1}},b=function(t){return t},j=function(t){throw t},m=function(t,r,e,o,u){return function(s,h){var l;return"function"!=typeof s&&(s=b),"function"!=typeof h&&(h=j),l=new i(n),l._type=t,l._resolver=r,l._fx=s,e&&(l._fe=h),u&&u.call(l),this._addNext(l),o?void 0:l}},w=d(!1),c=d(!0),u=d(t),i.prototype.then=i.prototype.map=m("then",w,!0),i.prototype.fail=i.prototype["catch"]=m("fail",c),i.prototype.always=i.prototype.fin=i.prototype["finally"]=m("always",u),i.prototype._always=m("always",u,!0,!1,function(){return this._immediate=!0}),i.prototype.spread=m("spread",function(t,r,n,e,i){var o,u;return o=Array.isArray(n)?n:[n],u=function(){return t.apply(void 0,o)},w.call(this,u,void 0,n,e,i)}),l=function(t,r,n,e,i){return(e&&!r||r===j)&&(r=function(){return setTimeout(function(){throw n instanceof Error?n:new Error(n)},0)},null!=("undefined"!=typeof process&&null!==process?process.domain:void 0)&&(r=process.domain.bind(r))),w.call(this,t,r,n,e,i)},i.prototype.done=m("done",l,!0,!0),_=function(t,r,n,i,o){var u,s,h;if(i||!Array.isArray(n))return w.call(this,t,r,n,i,o);if(0===n.length)return o(e,!1,!0),!0;for(this._serial||(this._execCount+=n.length-1),s=0,h=n.length;h>s;s++)u=n[s],this._serial?this._enqueue(u,i):w.call(this,t,r,u,!1,o)||o(u,!1,!1);return this._serial&&o(e,!1,!0),!0},i.prototype.forEach=i.prototype.each=m("forEach",_,!1,!1),i.prototype.singly=i.prototype.oneByOne=m("singly",_,!1,!1,function(){return this._serial=!0}),p=function(t){return function(r,n,i,o,u){var s,h;return o?!1:(h=this,s=function(r,n,o){return n?u(r,n,o):r===e?u(e,!1,o):r?(u(i,!1,o),t?h._doEnd():void 0):u(e,!1,o)},w.call(this,r,n,i,o,s))}},i.prototype.filter=m("filter",p(!1)),i.prototype.find=m("find",p(!0)),o=function(t){return function(r,n,i,o,u){var s,h,l,c,p,_,a;return Array.isArray(i)?(s=i,_=function(t){return t},c=Array.apply(null,Array(i.length)).map(function(){return e}),l=function(r,n,i){var o;return o=c[n]===e,t||o?(c[n]=i,o):!1}):"object"!=typeof i||f(i)||(s=Object.keys(i),_=function(t){return i[t]},c={},l=function(r,n,e){var i;return i=!c.hasOwnProperty(r),t||i?(c[r]=e,i):!1}),(null!=s?s.reduce(function(t,r){return t||f(_(r))},!1):void 0)?(h=0,a=this,p=!1,s.every(function(t,i){var o;return o=_(t),C(o,!1,function(o,_){if(!p){if(_)return p=!0,void u(o,!0);if(o!==e)return l(t,i,o)&&h++,s.length===h?(p=!0,w.call(a,r,n,c,!1,u)):null}}),!0}),!0):w.call(this,r,n,i,o,u)}},i.prototype.all=m("all",o(!1)),i.all=function(t){return i(t).all()},i.prototype.snapshot=m("snapshot",o(!0)),i.snapshot=function(t){return i(t).snapshot()},E=function(t,r,n,e,i){var o,u;return u=this,this._once?!0:(this._once=!0,o=function(t,r){return i(t,r,!0),u._doEnd()},w.call(this,t,r,n,e,o))},i.prototype.once=m("once",E),i.prototype.serial=m("serial",w,!0,!1,function(){return this._serial=!0}),g=function(t,r,n,e){return this._settle={v:n,isError:e},this._execCount=0,!0},i.prototype.settle=m("settle",g,!0,!1,function(){var t,r,n;return n=this,r=this._doEnd,t=function(t,e){return n._setValue(t,e),r(),n._doEnd=r},this._doEnd=function(){var r,e,i,o;return o=null!=(i=n._settle)?i:{v:void 0,isError:!1},e=o.v,r=o.isError,w.call(n,n._fx,n._fe,e,r,t)}}),v=function(t,r,n,e,o){var u,s,h;if(!t)return!1;s={},h=null;try{h=1===t.length?t(s):t(n,s),i(h).settle(function(){return i.all(s).then(function(t){return o(O(n,t),!1)}).fail(function(t){return o(t,!0),null})}).fail(function(t){return o(t,!0)})}catch(l){u=l,i(u).then(function(t){return o(t,!0)})}return!0},i.prototype.oi=m("oi",v),i.merge=function(){var t;return t=1<=arguments.length?q.call(arguments,0):[],i.binder(function(r,n){var e,o,u,s,h;for(u=0,o=[],s=0,h=t.length;h>s;s++)e=t[s],o.push(i(e).always(function(t,n){return r(t,n),null}).onEnd(function(){return++u===t.length?n():void 0}));return function(){var t,r,n,e;for(e=[],r=0,n=o.length;n>r;r++)t=o[r],e.push(t._doEnd());return e}})},C=function(t,r,n){var e,i;return e=[],i=function(t,r,i){var o,u,s,h;if(n(t,r,i),i){for(h=[],u=0,s=e.length;s>u;u++)o=e[u],h.push(o.stop());return h}},h(e,t,r,i)},h=function(t,r,n,o,u){var s,l,c,p;if(null==u&&(u=!0),r instanceof i)return t.push(r._always(function(r,n){return h(t,r,n,o,!1),null})),r.onEnd(function(){return h(t,e,!1,o,u)});if(!(p=a(r,function(r){return h(t,r,!0,o,u)})))return o(r,n,u);if(p!==!0){c=!1;try{return l=function(r){return function(n){return c?void 0:(c=!0,h(t,n,r,o,u))}},p.call(r,l(!1),l(!0))}catch(_){if(s=_,c)return;return c=!0,h(t,s,!0,o,u)}}},i.retry=function(t,r,n){return i._retry||(i._retry=new(require("./retry"))),i._retry["try"](t,r,n)},A=function(){var t,r,n,e,i,o,u;for(e=arguments[0],n=2<=arguments.length?q.call(arguments,1):[],o=0,u=n.length;u>o;o++){r=n[o];for(t in r)i=r[t],void 0!==i&&(e[t]=i)}return e},O=function(){var t;return t=1<=arguments.length?q.call(arguments,0):[],A.apply(null,[{}].concat(q.call(t)))}}).call(this);
},{"../lib/nexttick":1,"./retry":2}]},{},[3]);
