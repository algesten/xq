(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var nextTick;!function(){function e(){for(;n.next;){n=n.next;var t=n.task;n.task=void 0;var o=n.domain;o&&(n.domain=void 0,o.enter());try{t()}catch(a){if(s)throw o&&o.exit(),setTimeout(e,0),o&&o.enter(),a;setTimeout(function(){throw a},0)}o&&o.exit()}i=!1}var n={task:void 0,next:null},t=n,i=!1,o=void 0,s=!1;if(nextTick=function(e){t=t.next={task:e,domain:s&&process.domain,next:null},i||(i=!0,o())},"undefined"!=typeof process&&process.nextTick)s=!0,o=function(){process.nextTick(e)};else if("function"==typeof setImmediate)o="undefined"!=typeof window?setImmediate.bind(window,e):function(){setImmediate(e)};else if("undefined"!=typeof MessageChannel){var a=new MessageChannel;a.port1.onmessage=function(){o=c,a.port1.onmessage=e,e()};var c=function(){a.port2.postMessage(0)};o=function(){setTimeout(e,0),c()}}else o=function(){setTimeout(e,0)};return nextTick}(),module.exports=nextTick;
},{}],2:[function(require,module,exports){
(function(){var t,n,e,r={}.hasOwnProperty;n=require("./xq"),e=function(t,n){var e,o;for(e in n)r.call(n,e)&&(o=n[e],t[e]=o);return t},module.exports=t=function(){function t(t){e(this,t)}return t.prototype.min=0,t.prototype.base=1.2,t.prototype.exp=33,t.prototype.defaultMax=5,t.prototype.defaultDelay=1e3,t.prototype.delay=function(t,n){return this.min+Math.floor(n*Math.pow(this.base,Math.min(this.exp,t))+n/2*Math.random())},t.prototype["try"]=function(t,e,r){var o,u;return u=this,2===arguments.length?(t=arguments[0],r=arguments[1],e=this.defaultDelay):1===arguments.length&&(r=arguments[0],t=this.defaultMax,e=this.defaultDelay),o=null,n.binder(function(i,a){var l;return(l=function(s){var f,h,p;return s>=t?(i(o,!0),void a()):(p=r(),f=!1,h=function(t){return f?void 0:(f=!0,o=t,(e=u.delay(s,e))>=0?setTimeout(function(){return l(s+1)},e):(i(new Error("Abort with "+e),!0),a()),null)},p instanceof n?p.then(i,h).onEnd(function(){return p.isRejected()?void 0:a()}):p.then(function(t){return i(t),a()},h),null)})(0),null})},t}()}).call(this);
},{"./xq":3}],3:[function(require,module,exports){
(function(){var t,r,e,n,i,o,u,s,h,p,_,c,l,f,a,d,y,v,E,x,g,w,m,j=function(t,r){return function(){return t.apply(r,arguments)}},b=[].slice;e={ini:0},r={fin:0},n={nva:0},s=0,module.exports=i=function(){function t(r){this._doEnd=j(this._doEnd,this),this._resolverExit=j(this._resolverExit,this),this._end=j(this._end,this),this._reject=j(this._reject,this),this._resolve=j(this._resolve,this),this._pushError=j(this._pushError,this),this._push=j(this._push,this);var n,i;return this instanceof t?(this._cnt=s++,void(r===e?this._value=e:("boolean"==typeof(n=arguments[1])&&(i=n),i?this._reject(r):this._resolve(r)))):new t(r)}return t.prototype._value=e,t.prototype._isError=!1,t.prototype._isEnded=!1,t.prototype._isEnding=!1,t.prototype._type="root",t.prototype._resolver=null,t.prototype._fx=null,t.prototype._fe=null,t.prototype._prev=null,t.prototype._next=null,t.prototype._execCount=0,t.prototype._serial=!1,t.prototype._head=null,t.prototype._tail=null,t.prototype._onEnd=null,t.prototype._endOnError=!1,t.prototype.inspect=function(){var t;return t=this._value===e?"_":this._value+"","{"+this._type+this._cnt+": v:"+t+", err:"+this._isError+", "+("end:"+this._isEnded+", exec:"+this._execCount+", ser:"+this._serial+"}")},t.reject=function(r){return new t(r,!0)},t.resolver=function(r){var n;return n=new t(e)._defer(),r(function(t){return void n.resolve(t)},function(t){return void n.reject(t)}),n.promise},t.binder=function(r){var n,i,o,u;return n=new t(e)._defer(),o=function(t,r){return void(r?n.pushError(t):n.push(t))},i=function(){return void n.end()},u=r(o,i),"function"==typeof u&&n.promise.onEnd(u),n.promise},t.defer=function(r){return new t(e)._defer(r)},t.prototype.isPending=function(){return!this._isEnded},t.prototype.isEnded=function(){return this._isEnded},t.prototype.isRejected=function(){return this._isEnded&&this._isError},t.prototype.isFulfilled=function(){return this._isEnded&&!this._isError},t.prototype._defer=function(t){var r;return void 0!==t&&this._push(t),r=this,this._def||(this._def={push:r._push,pushError:r._pushError,resolve:r._resolve,reject:r._reject,end:r._end,promise:r,toString:function(){return"[object Defer]"}})},t.prototype._push=function(t){return this._exec(t,!1)},t.prototype._pushError=function(t){return this._exec(t,!0)},t.prototype._resolve=function(t){return this._push(t)._end()},t.prototype._reject=function(t){return this._pushError(t)._end()},t.prototype._end=function(){return this._exec(r,!1)},t.prototype._exec=function(t,e,n){var i;return this._isEnded||this._isEnding&&!n?this:t===r?(this._isEnding=!0,0!==this._execCount||(null!=(i=this._head)?i.next:void 0)||this._doEnd(),this):this._serial&&this._execCount>0?(this._enqueue(t,e),this):(this._execCount++,this._resolver(this._fx,this._fe,t,e,this._resolverExit)||this._resolverExit(t,e,!0),this)},t.prototype._enqueue=function(t,r){return this._head||(this._head={next:null},this._tail=this._head),this._tail=this._tail.next={next:null,v:t,isError:r}},t.prototype._nextEvent=function(){return this._head&&this._head.next?this._head=this._head.next:null},t.prototype._execNext=function(){var t;return 0===this._execCount&&(t=this._nextEvent())&&this._exec(t.v,t.isError,!0),this},t.prototype._resolver=function(t,r,e,n,i){return m(e,n,i),!0},t.prototype._resolverExit=function(t,r,e){var n,i,o;return e&&this._execCount--,this._setValue(t,r),n=this._isEnding&&0===this._execCount&&!(null!=(o=this._head)?o.next:void 0),i=r&&this._endOnError,(n||i)&&this._doEnd(),this._execNext()},t.prototype._doEnd=function(){var t,e,n,i;if(this._isEnded)return this;if(this._isEnded=!0,null!=(i=this._prev)&&i._removeNext(this),this._head=this._tail=null,this._onEnd&&(t=function(){var t,r,n,i;for(n=this._onEnd,i=[],t=0,r=n.length;r>t;t++)e=n[t],i.push(v(e));return i}.call(this)),t&&(n=t.reduce(function(t,r){return t||r},null)),this._forward(r,!1),n)throw n;return this},t.prototype._setValue=function(t,r){return this._isEnded||t===n?this:(this._value=t,this._isError=r,this._forward(t,r))},t.prototype._forward=function(t,r){var e;return(null!=(e=this._next)?e.length:void 0)?(this._next.forEach(function(e){return e._exec(t,r)}),this):this},t.prototype._addNext=function(t){return this._next||(this._next=[]),this._next.push(t),t._prev=this,this._value!==e&&(t._exec(this._value,this._isError),this._isEnded&&!t._isEnded&&t._exec(r,!1)),t},t.prototype._removeNext=function(t){var r;return delete t._prev,(r=this._next.indexOf(t)>=0)&&this._next.splice(r,1),this},t.prototype.onEnd=function(t){var r;if(this._onEnd||(this._onEnd=[]),this._onEnd.push(t),this._isEnded&&(r=v(t)),r)throw r;return this},t.prototype.endOnError=function(){return this._endOnError=!0,this},t.prototype.toString=function(){return"[object Promise]"},t}(),i.toString=function(){return"[object X]"},v=function(t){var r;try{return void t()}catch(e){return r=e}},f=function(t,r){var e,n,i;try{return null==t?!1:"object"!=(i=typeof t)&&"function"!==i?!1:(n=t.then,"function"==typeof n?n:!1)}catch(o){return e=o,r(e),!0}},l=function(t){return t instanceof i||f(t)},t={always:0},d=require("../lib/nexttick"),a=function(r){return function(e,n,i,o,u){var s,h,p;return(s=r===t||r===o?e:r===!1&&o===!0?n:void 0)?(p=this,h=this._immediate?function(t){return t()}:d,h(function(){var e,n;try{if(n=s.apply(void 0,r===t?[i,o]:[i]),n===p)throw new TypeError("f returned same promise");return m(n,!1,u)}catch(h){return e=h,m(e,!0,u)}}),!0):!1}},w=function(t){return t},g=function(t){throw t},E=function(t,r,n,o,u,s){return function(h,p){var _;return"function"!=typeof h&&(h=w),"function"!=typeof p&&(p=g),_=new i(e),_._type=t,_._resolver=r,_._fx=h,n&&(_._fe=p),_._serial=!!u,_._immediate=!!s,this._addNext(_),o?void 0:_}},x=a(!1),p=a(!0),u=a(t),i.prototype.then=i.prototype.map=E("then",x,!0),i.prototype.fail=i.prototype["catch"]=E("fail",p),i.prototype.always=i.prototype.fin=i.prototype["finally"]=E("always",u),i.prototype._always=E("always",u,!0,!1,!1,!0),i.prototype.spread=E("spread",function(t,r,e,n,i){var o,u;return o=Array.isArray(e)?e:[e],u=function(){return t.apply(void 0,o)},x.call(this,u,void 0,e,n,i)}),h=function(t,r,e,n,i){return(n&&!r||r===g)&&(r=function(){return d(function(){throw e instanceof Error?e:new Error(e)})},null!=("undefined"!=typeof process&&null!==process?process.domain:void 0)&&(r=process.domain.bind(r))),x.call(this,t,r,e,n,i)},i.prototype.done=E("done",h,!0,!0),c=function(t,r,e,i,o){var u,s,h;if(i||!Array.isArray(e))return x.call(this,t,r,e,i,o);if(0===e.length)return o(n,!1,!0),!0;for(this._serial||(this._execCount+=e.length-1),s=0,h=e.length;h>s;s++)u=e[s],this._serial?this._enqueue(u,i):x.call(this,t,r,u,!1,o)||o(u,!1,!1);return this._serial&&o(n,!1,!0),!0},i.prototype.forEach=i.prototype.each=E("forEach",c,!1,!1,!1),i.prototype.singly=i.prototype.oneByOne=E("singly",c,!1,!1,!0),_=function(t,r,e,i,o){var u;return i?!1:(u=function(t,r,i){return r?o(t,r,i):t===n?o(n,!1,i):t?o(e,!1,i):o(n,!1,i)},x.call(this,t,r,e,i,u))},i.prototype.filter=E("filter",_),o=function(t,r,e,i,o){var u,s,h,p,_,c,f,a;return Array.isArray(e)?(u=e,f=function(t){return t},p=Array.apply(null,Array(e.length)).map(function(){return n}),c=[],h=function(t,r,e,i){return p[r]!==n?!1:(p[r]=e,c.push(i),!0)}):"object"!=typeof e||l(e)||(u=Object.keys(e),f=function(t){return e[t]},p={},c=[],h=function(t,r,e,n){return p.hasOwnProperty(t)?!1:(p[t]=e,c.push(n),!0)}),(null!=u?u.reduce(function(t,r){return t||l(f(r))},!1):void 0)?(s=0,a=this,_=!1,u.every(function(e,i){var l;return l=f(e),m(l,!1,function(l,f,d,y){var v,E,g;if(!_){if(f)return _=!0,void o(l,!0);if(l!==n){if(h(e,i,l,y)&&s++,u.length===s){for(_=!0,E=0,g=c.length;g>E;E++)(v=c[E])();return x.call(a,t,r,p,!1,o)}return null}}}),!0}),!0):x.call(this,t,r,e,i,o)},i.prototype.all=E("all",o),i.all=function(t){return i(t).all()},y=function(t,r,e,n,i){var o,u;return u=this,this._once?!0:(this._once=!0,o=function(t,r,e,n){return i(t,r,!0),u._doEnd(),n()},x.call(this,t,r,e,n,o))},i.prototype.once=E("once",y),i.prototype.serial=E("serial",x,!0,!1,!0),i.merge=function(){var t;return t=1<=arguments.length?b.call(arguments,0):[],i.binder(function(r,e){var n,o,u,s,h;for(u=0,o=[],s=0,h=t.length;h>s;s++)n=t[s],o.push(i(n).always(function(t,e){return r(t,e),null}).onEnd(function(){return++u===t.length?e():void 0}));return function(){var t,r,e,n;for(n=[],r=0,e=o.length;e>r;r++)t=o[r],n.push(t._doEnd());return n}})},m=function(t,r,e,o,u){var s,h,p,_,c,l;if(null==o&&(o=!0),null==u&&(u=function(){}),l=u,t instanceof i)return s=t._always(function(t,r){return l=function(){return u(),s._doEnd()},m(t,r,e,!1,l),null}),t.onEnd(function(){return m(n,!1,e,o,l)});if(!(c=f(t,function(t){return m(t,!0,e,o,l)})))return e(t,r,o,l);if(c!==!0){_=!1;try{return p=function(t){return function(r){return _?void 0:(_=!0,m(r,t,e,o,l))}},c.call(t,p(!1),p(!0))}catch(a){if(h=a,_)return;return _=!0,m(h,!0,e,o,l)}}},i.retry=function(t,r,e){return i._retry||(i._retry=new(require("./retry"))),i._retry["try"](t,r,e)}}).call(this);
},{"../lib/nexttick":1,"./retry":2}]},{},[3]);
